# virtual_machine_notes



## 一、在 VMware 17 Pro 上安装 Windows 7 虚拟机

### 1. 下载 Windows 7 镜像

在 [MSDN 原站](https://msdn.itellyou.cn/) 或 [新站](https://next.itellyou.cn/) 找到 Windows 7 镜像文件。

### 2. 安装步骤

按照安装向导的提示一直点击“下一步”，安装过程中可以从网上搜索一个 Windows 7 的密钥进行激活。

### 3. 安装过程中可能遇到的问题及解决方法

#### （1）网络问题

- **设置 NAT 模式：**
  在虚拟机的“设置”选项中，选择 **网络适配器**，将连接模式设置为 **NAT**，并勾选“启动连接”。启动虚拟机后，可以通过 `ping` 命令测试虚拟机是否能够与宿主机通信。
- **设置代理（如果宿主机使用代理）：**
  1. 打开 **控制面板** -> **网络和 Internet** -> **网络和共享中心** -> **Internet 选项** -> **连接** -> **局域网设置**。
  2. 在 **代理服务器** 部分，填写宿主机的 IP 地址和使用的代理端口号。

#### （2）共享文件夹

1. 设置宿主机共享：
   - 在宿主机上，右键需要共享的文件夹，选择 **属性** -> **共享**，为共享选择用户并设置权限。设置完成后，路径将会显示共享位置。
2. 设置虚拟机共享：
   - 在虚拟机的设置页面，选择 **选项** 标签，启用 **共享文件夹** 并添加宿主机共享的文件夹路径。
   - 在虚拟机内打开 **计算机**，右键选择 **映射网络驱动器**，选择一个未使用的盘符并填写宿主机的共享路径，即可访问共享文件夹内容。

#### （3）安装更新补丁

- Windows 7 发布后，微软推送了大量补丁。可以从 [这里](https://gist.github.com/growtopiajaw/8e4a99bbd8135a54847191252f3e205d) 下载离线更新包，手动安装补丁。

#### （4）安装 VMware Tools

如果 **VMware Tools** 的安装选项是灰色的，可以按以下步骤解决：

1. 关闭虚拟机。
2. 在虚拟机设置中，找到 **CD/DVD**，将其设置为“自动检测”。
3. 如果弹出“无法连接虚拟设备”的错误提示：
   - 关闭虚拟机。
   - 将 **CD/DVD** 设置为“使用 ISO 映像文件”，并选择用于安装的 Windows 7 镜像。
4. 重新启动虚拟机，检查 **VMware Tools** 是否可以安装。
